import e from"postcss";import t,{defaultOptions as s,standardizeSafelist as o,mergeExtractorSelectors as n}from"purgecss";const r=e.plugin("postcss-plugin-purgecss",(function(e){return async function(r,c){const i=new t,p={...s,...e,safelist:o(null==e?void 0:e.safelist)};e&&"function"==typeof e.contentFunction&&(p.content=e.contentFunction(r.source&&r.source.input.file||"")),i.options=p;const{content:a,extractors:u}=p,l=a.filter(e=>"string"==typeof e),m=a.filter(e=>"object"==typeof e),f=await i.extractSelectorsFromFiles(l,u),g=await i.extractSelectorsFromString(m,u),d=n(f,g);i.walkThroughCSS(r,d),i.options.fontFace&&i.removeUnusedFontFaces(),i.options.keyframes&&i.removeUnusedKeyframes(),i.options.variables&&i.removeUnusedCSSVariables(),i.options.rejected&&i.selectorsRemoved.size>0&&(c.messages.push({type:"purgecss",plugin:"postcss-purgecss",text:`purging ${i.selectorsRemoved.size} selectors:\n        ${Array.from(i.selectorsRemoved).map(e=>e.trim()).join("\n  ")}`}),i.selectorsRemoved.clear())}}));export default r;
